<?xml version="1.0"?>
<launch>
	<arg name="ns" default="/limo1"/>
	<arg name="id" default="limo1"/>

	<group  ns="$(arg ns)">
		<node pkg="amcl" type="amcl" name="amcl" output="screen">
			<rosparam file="$(find empty_pkg)/simulation/param/amcl/amcl_params_diff.yaml" command="load" />
			<param name="initial_pose_x"            value="0"/>
			<param name="initial_pose_y"            value="0"/>
			<param name="initial_pose_a"            value="0"/>

			<param name="global_frame_id" value="$(arg id)/map"/>
			<param name="odom_frame_id" value="$(arg id)/odom"/>
			<param name="base_frame_id" value="$(arg id)/base_footprint"/>

			<remap from="scan" to="$(arg ns)/scan"/>
			<remap from="initialpose" to="$(arg ns)/initialpose"/> 
			<remap from="amcl_pose" to="$(arg ns)/amcl_pose"/>
			<remap from="particlecloud" to="$(arg ns)/particlecloud"/>
		</node>
	</group>

    <!--  ************** Navigation ***************  -->
	<group  ns="$(arg ns)">
		<node pkg="move_base" type="move_base" respawn="false" name="move_base" output="screen">
			<rosparam file="$(find empty_pkg)/simulation/param/nav/costmap_common_params.yaml" command="load" ns="global_costmap" />
			<rosparam file="$(find empty_pkg)/simulation/param/nav/costmap_common_params.yaml" command="load" ns="local_costmap" />
			<rosparam file="$(find empty_pkg)/simulation/param/nav/local_costmap_params.yaml" command="load" />
			<rosparam file="$(find empty_pkg)/simulation/param/nav/global_costmap_params.yaml" command="load" />
			<rosparam file="$(find empty_pkg)/simulation/param/nav/planner.yaml" command="load" />

			<param name="base_global_planner" value="global_planner/GlobalPlanner" />
			<param name="planner_frequency" value="1.0" />
			<param name="planner_patience" value="5.0" />
			<!--param name="base_local_planner" value="base_local_planner/TrajectoryPlannerROS" /-->
			<param name="base_local_planner" value="dwa_local_planner/DWAPlannerROS" />
			<param name="controller_frequency" value="5.0" />
			<param name="controller_patience" value="15.0" />
			<param name="clearing_rotation_allowed" value="true" />

			<param name="global_costmap/robot_base_frame" value="$(arg id)/base_link"/>
			<param name="local_costmap/robot_base_frame" value="$(arg id)/base_link"/>
			<param name="local_costmap/global_frame" value="$(arg id)/odom"/>
			<param name="global_costmap/global_frame" value="$(arg id)/map"/>

			<param name="global_costmap/scan/sensor_frame" value="$(arg ns)/base_scan"/>
			<param name="global_costmap/obstacle_layer/scan/sensor_frame" value="$(arg ns)/base_scan"/>
			<param name="local_costmap/scan/sensor_frame" value="$(arg ns)/base_scan"/>
			<param name="local_costmap/obstacle_layer/scan/sensor_frame" value="$(arg ns)/base_scan"/>

		</node>
	</group>

	<!--  **************** Visualisation ****************  -->
	<node name="rviz" pkg="rviz" type="rviz" args="-d $(find empty_pkg)/simulation/rviz/navigation_diff.rviz" ns="$(arg ns)"/>
</launch>

